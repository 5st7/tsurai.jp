{"_path":"/articles/stop-using-cpu-limits-with-kubernetes","_dir":"articles","_draft":false,"_partial":false,"_locale":"","title":"頼むからKubernetesでCPU制限を使うのはやめてくれという記事を読んだ","description":"「頼むからKubernetesでCPU制限を使うのはやめてくれ」という記事を読んでなるほどな〜〜〜と思った一方で思うところがあったので感想をかく","author":{"name":"5st7","avatarUrl":"https://pbs.twimg.com/profile_images/1042510623962275840/1Iw_Mvud_400x400.jpg","link":"https://twitter.com/5st7"},"date":"2023-11-26T00:00:00.000Z","layout":"article","body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"「"},{"type":"element","tag":"a","props":{"href":"https://home.robusta.dev/blog/stop-using-cpu-limits","rel":["nofollow"]},"children":[{"type":"text","value":"頼むからKubernetesでCPU制限を使うのはやめてくれ"}]},{"type":"text","value":"」という記事を読んでなるほどな〜〜〜と思った一方で思うところがあったので感想をかく"}]},{"type":"element","tag":"h3","props":{"id":"要約"},"children":[{"type":"text","value":"要約"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"KubernetesのCPU制限の問題: KubernetesにおけるCPU制限は、多くの場合、害になることが多い。実際、これらの制限はKubernetesのCPUスロットリング（処理能力の制限）の主要な原因である。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"CPU制限のアンチパターン: 著者は、CPU制限が有害である理由を3つの比喩を用いて説明する。これらの比喩では、CPUを水、CPUの欠乏を死にたとえ、CPUの使用がその次の瞬間に影響を与えないという点で、水が更新される資源として描かれる。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"三つの物語: 著者は、CPU制限に関する三つの物語を紹介し、制限なし、制限あり、要求に基づくシナリオの違いを示す。これらの物語では、資源（水）が限られている状況での分配の問題を示している。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"CPU制限の代わりにリクエストを使用: 著者は、CPU制限を削除し、代わりにCPUリクエストを定義することで、CPUハングリーポッドが他のポッドに影響を与えるのを防ぐことができると主張する。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"リクエストと制限の違い: 記事ではCPUリクエストと制限の違いを明確に説明し、ベストプラクティスとしてCPUリクエストの使用を推奨する。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"メモリ制限とリクエストに関する注意: この記事はCPUに焦点を当てているが、メモリは圧縮不可能なリソースであるため、メモリに関しては常に制限とリクエストを使用し、両者を等しく設定することを推奨している。"}]},{"type":"element","tag":"h2","props":{"id":"感想"},"children":[{"type":"text","value":"感想"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"リミットにかかりCPUがスロットルされるとプロセスがCPUを再び使用できるようになるまで待足されるので、例えばP99タイルに大きく影響がでうるのでなるほどなと思った"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"メモリ制限に関してはlimitとrequestを同値に設定する点において完全同意"}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"要約","depth":3,"text":"要約"},{"id":"感想","depth":2,"text":"感想"}]}},"_type":"markdown","_id":"content:articles:stop-using-cpu-limits-with-kubernetes.md","_source":"content","_file":"articles/stop-using-cpu-limits-with-kubernetes.md","_extension":"md"}